!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("LazyLoad",[],e):"object"==typeof exports?exports.LazyLoad=e():t.LazyLoad=e()}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){const n=r(1);class i{constructor(t){this.opts=t,this._checkOpts();const{selectors:e}=t;this.elements={},this._attached=!1,this.updateWithSelectors(e);let r=this;this.lazyEventListener=()=>{r.lazyLoad()}}attach(){window.addEventListener("resize",this.lazyEventListener),window.addEventListener("scroll",this.lazyEventListener),this._attached=!0}_checkOpts(){const t=n.checkObj(this.opts,{selectors:t=>n.isArrayOf(t,n.isString),loadHandler:t=>n.isOr(n.isUndefined(t),n.isFunction(t)),errorHandler:t=>n.isOr(n.isUndefined(t),n.isFunction(t)),advance:t=>n.isOr(n.isUndefined(t),n.isNumber(t)),setNaturalSizeAfterLoad:t=>n.isOr(n.isUndefined(t),n.isBool(t)),lazyAttribute:t=>n.isOr(n.isUndefined(t),n.isString(t))});n.assert(t.result,t.status),n.setObjDefault(this.opts,"advance",i.ADVANCE_DEFAULT),n.setObjDefault(this.opts,"setNaturalSizeAfterLoad",i.SET_NATURAL_SIZE_AFTER_LOAD_DEFAULT),n.setObjDefault(this.opts,"lazyAttribute",i.LAZY_ATTRIBUTE_DEFAULT)}lazyLoad(){this._attached||this.attach();const{advance:t}=this.opts;for(let e in this.elements){if(s(this.elements[e][0],t)){const t=this.elements[e];delete this.elements[e],t.forEach(t=>this._loadElement(t));break}}0===this.elements.length&&this._attached&&this.detach()}_loadElement(t){const{loadHandler:e,errorHandler:r,setNaturalSizeAfterLoad:n,lazyAttribute:i}=this.opts;let s=e(t);t.onload=()=>{n&&(t.naturalHeight&&(t.style.height=t.naturalHeight+"px"),t.naturalWidth&&(t.style.width=t.naturalWidth+"px")),s&&s(),this.lazyLoad()},t.onerror=()=>{s&&s(),r&&r(t),this.lazyLoad()},t.src=t.getAttribute(i)}detach(){window.removeEventListener("resize",this.lazyEventListener),window.removeEventListener("scroll",this.lazyEventListener),this._attached=!1}updateWithSelectors(t){n.assert(n.isArray(t),"haniwa-lazy-load: updateWithSelectors() - selectors must be an array");let e=this;t.forEach(t=>{[...document.querySelectorAll(t)].forEach(t=>{const r=t.getAttribute(this.opts.lazyAttribute);e.elements[r]?e.elements[r].push(t):e.elements[r]=[t]})})}static buildDefaultLoadHandler(t,e){return function(r){let n=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div");n.classList.add(t),i.classList.add(e),n.style.position="relative",s.style.position="absolute",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)";let o=getComputedStyle(i);s.style.width=o.width,s.style.height=o.height,n.append(s),s.append(i),r.parentNode&&r.parentNode.replaceChild(n,r),n.append(r);const a=r.style.visibility;return r.style.visibility="hidden",function(){n.parentNode&&n.parentNode.replaceChild(r,n),r.style.visibility=a}}}}i.ADVANCE_DEFAULT=50,i.SET_NATURAL_SIZE_AFTER_LOAD_DEFAULT=!0,i.LAZY_ATTRIBUTE_DEFAULT="data-src";function s(t,e=0){let r=t.getBoundingClientRect();return!!(r.top<window.innerHeight+e&&r.left<window.innerWidth+e&&r.bottom>0-e&&r.right>0-e)}t.exports={LazyLoader:i,UnlazyLoader:class{static unlazy(t){const{selectors:e,setNaturalSizeAfterLoad:r,lazyAttribute:n}=t;e.forEach(t=>{[...document.querySelectorAll(t)].forEach(t=>{t.onload=()=>{(r||void 0===r)&&(t.naturalHeight&&(t.style.height=t.naturalHeight+"px"),t.naturalWidth&&(t.style.width=t.naturalWidth+"px"))};let e=n||i.LAZY_ATTRIBUTE_DEFAULT;t.src=t.getAttribute(e),t.removeAttribute(e)})})}},isElementVisible:s,throttle:function(t,e){let r=0;return function(){let n=Date.now();n-r>e&&(t.apply(null,arguments),r=n)}}}},function(t,e){class r{static isString(t){return"string"==typeof t||t instanceof String}static isNumber(t){return"number"==typeof t||t instanceof Number}static isFiniteNumber(t){return this.isNumber(t)&&isFinite(t)}static isArray(t){return t.constructor===Array}static isFunction(t){return t.constructor===Function}static isObject(t){return"object"==typeof t}static isNull(t){return null===t}static isUndefined(t){return void 0===t}static isBool(t){return"boolean"==typeof t||t instanceof Boolean}static isSymbol(t){return"symbol"==typeof t||t instanceof Symbol}static objectKeysContain(t,e){return e in t}static objectValuesContain(t,e){return-1!==Object.values(t).indexOf(e)}static isElement(t){return t instanceof Element||t instanceof HTMLDocument}static isDefined(t){return void 0!==t}static isArrayOf(t,e){return r.isAnd(r.isArray(t),0!==t.length,t.every(t=>e(t)))}static assert(t,e){if(!this.isBool(t))throw new Error("assert() - not boolean in arguments");if(!1===t)throw new Error("assert() - fail: "+e)}static assertAnd(){if(0===arguments.length)return;let t=this.isString(arguments[arguments.length-1]),e=t?arguments[arguments.length-1]:"",r=t?arguments.length-1:arguments.length;for(let t=0;t<r;++t){if(!this.isBool(arguments[t]))throw new Error("assertAnd() - not boolean in arguments");if(!0!==arguments[t])throw new Error("assertAnd() - fail at argument "+t+": "+e)}}static isAnd(){for(let t=0;t<arguments.length;++t)if(!0!==arguments[t])return!1;return!0}static assertOr(){if(0===arguments.length)return;let t=this.isString(arguments[arguments.length-1]),e=t?arguments[arguments.length-1]:"",r=t?arguments.length-1:arguments.length;for(let t=0;t<r;++t){if(!this.isBool(arguments[t]))throw new Error("assertOr() - not boolean in arguments");if(!0===arguments[t])return}throw new Error("assertOr() - fail at argument "+i+": "+e)}static isOr(){for(let t=0;t<arguments.length;++t)if(!0===arguments[t])return!0;return!1}static setObjDefault(t,e,r){return e in t||(t[e]=r),t}static checkObj(t,e){let r=0;for(let n in e){if(!e[n](t[n]))return{result:!1,status:`Rule number ${r} is not correct`};++r}return{result:!0,status:"ok"}}}t.exports=r}])}));